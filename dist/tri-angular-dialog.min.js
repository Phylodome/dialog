/*!
 * triAngular Dialog
 */
!function(a){"use strict";a.directive("dialogRoot",["$compile","$rootScope","$document","$animate","dialogConfig","dialogManager","dialogUtilities",function(a,b,c,d,e,f,g){var h=function(c,h){var i=angular.element("<div />"),j=h.dialogRoot||e.mainNamespace;return c.append(i),i.addClass(g.extendClass(h.dialogRoot,e.maskClass)),i.bind("click",function(){var a=f.getUpperDialog();a.modal||(b.$emit(g.eventLabel(j,"close"),a),b.$digest())}),function(c,h,k){var l=g.extendClass(k.dialogRoot,e.rootClass),m=function(e,f){h.addClass(l),d.enter(a(g.getElem(f))(c),h,i),!b.$$phase&&b.$digest(),g.updateMask(i,j)},n=function(a,b){f.unRegisterDialog(b.label),!f.hasAny(j)&&h.removeClass(l),g.updateMask(i,j)};b.$on(g.eventLabel(j,"open"),m),b.$on(g.eventLabel(j,"close"),n)}};return{restrict:"A",compile:h}}]),a.directive("body",["$rootScope","$document","dialogConfig","dialogManager",function(a,b,c,d){var e=function(){b.on("keydown keypress",function(b){var e=d.getUpperDialog();27===b.which&&e&&(a.$emit((e.namespace||c.mainNamespace)+".dialog.close",e),a.$digest())})};return{restrict:"E",link:e}}]),a.directive("dialog",["$rootScope","$http","$animate","$compile","$controller","$templateCache","dialogManager",function(a,b,c,d,e,f,g){var h=function(h,i,j){var k=g.dialogs[j.dialog],l={$data:k.data,$scope:h},m=function(a){var b;k.controller&&(b=e(k.controller,l),i.data("$ngControllerController",b),i.children().data("$ngControllerController",b),k.controllerAs&&(h[k.controllerAs]=b)),a(h)};b.get(k.templateUrl,{cache:f}).success(function(a){i.html(a),m(d(i.contents())),h.$emit("$triNgDialogTemplateLoaded")}).error(function(){h.$emit("$triNgDialogTemplateError")}),h.$emit("$triNgDialogTemplateRequested"),h.closeClick=function(){a.$emit(k.namespace+".dialog.close",k)},a.$on(k.namespace+".dialog.close",function(a,b){b.label==k.label&&(h.$destroy(),c.leave(i))})};return{restrict:"A",link:h,scope:!0}}]),a.constant("dialogConfig",{baseZindex:3e3,rootClass:"dialog-root",maskClass:"dialog-mask",dialogClass:"dialog",mainNamespace:"main",showClass:"show"}),a.factory("dialogData",["$log","dialogConfig",function(a,b){var c=function(){return angular.extend(this,{controller:null,controllerAs:null,dialogClass:"",topOffset:null,modal:!1,namespace:b.mainNamespace,templateUrl:null})};return angular.extend(c.prototype,{_updateDialogConfigData:function(b,c){return b.templateUrl||a.error(new Error('triNgDialog.DialogData() - initialData must contain defined "templateUrl"')),angular.extend(this,b,{data:c})}}),function(a,b){return(new c)._updateDialogConfigData(a,b)}}]),a.provider("dialogManager",["dialogConfig",function(a){var b=function(a,b,c){var d=function(){return angular.extend(this,{dialogs:[]})};return angular.extend(d.prototype,{hasAny:function(a){return this.dialogs.some(function(b){return b.namespace===a})},getUpperDialog:function(){var a=this.dialogs.length;return a>0&&this.dialogs[a-1]},registerDialog:function(a){return a.label=this.dialogs.push(a)-1,a},unRegisterDialog:function(a){var b=this.dialogs[a];return b&&b.label===a?(this.dialogs.splice(a,1),!0):!1},triggerDialog:function(d,e){return d=d||{},a.$emit((d.namespace||b.mainNamespace)+".dialog.open",this.registerDialog(c(d,e))),this}}),new d};return{config:function(b){return angular.extend(a,b),this},$get:["$rootScope","dialogConfig","dialogData",b]}}]),a.service("dialogUtilities",["$animate","dialogConfig","dialogManager",function(a,b,c){var d=document.body,e=document.documentElement,f=function(){};return angular.extend(f.prototype,{getViewportSize:function(a){return a.isW3C?function(){return{width:window.innerWidth,height:window.innerHeight}}:a.isIE?function(){return{width:e.clientWidth,height:e.clientHeight}}:function(){return{width:d.clientWidth,height:d.clientHeight}}}({isW3C:"undefined"!=typeof window.innerWidth,isIE:"undefined"!=typeof e&&"undefined"!=typeof e.clientWidth&&0!=e.clientWidth}),getTopScroll:function(){return d.scrollTop||e.scrollTop},getTopOffset:function(a){var b=this.getViewportSize().height,c=this.getTopScroll(),d=parseInt(a,10);return angular.isUndefined(a)?c+b/5+"px":isNaN(d)?c+"px":angular.isString(a)&&"%"===a.charAt(a.length-1)?c+b*d/100+"px":c+d+"px"},getElem:function(a){return angular.element('<section dialog="'+a.label+'"></section>').addClass(b.dialogClass+" "+a.dialogClass).css({zIndex:b.baseZindex+2*(a.label+1),top:this.getTopOffset(a.topOffset)})},updateMask:function(d,e){c.hasAny(e)?(d.css("z-index",b.baseZindex+2*c.dialogs.length-1),a.addClass(d,b.showClass)):a.removeClass(d,b.showClass,function(){d.removeAttr("style")})},eventLabel:function(a,b){return a+".dialog."+b},extendClass:function(a,b){return a?a+"-"+b:b}}),new f}])}(angular.module("triNgDialog",["ng","ngAnimate"]));
//# sourceMappingURL=tri-angular-dialog.min.js.map