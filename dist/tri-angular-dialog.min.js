/*!
 * triAngular Dialog
 */
!function(a){"use strict";a.directive("dialog",["$rootScope","$http","$animate","$compile","$controller","$templateCache","dialogManager",function(a,b,c,d,e,f,g){var h=function(h,i,j){var k=g.dialogs[j.dialog],l={$data:k.data,$scope:h},m=function(a){var b;k.controller&&(b=e(k.controller,l),i.data("$ngControllerController",b),i.children().data("$ngControllerController",b),k.controllerAs&&(h[k.controllerAs]=b)),a(h)};b.get(k.templateUrl,{cache:f}).success(function(a){i.html(a),m(d(i.contents())),h.$emit("$triNgDialogTemplateLoaded")}).error(function(){h.$emit("$triNgDialogTemplateError")}),h.$emit("$triNgDialogTemplateRequested"),h.closeClick=function(){a.$emit(k.namespace+".dialog.close",k)},a.$on(k.namespace+".dialog.close",function(a,b){b.label==k.label&&(h.$destroy(),c.leave(i))})};return{restrict:"A",link:h,scope:!0}}]),a.directive("dialogRoot",["$compile","$location","$rootScope","$interpolate","$document","$animate","dialogConfig","dialogManager",function(a,b,c,d,e,f,g,h){var i=document.body,j=document.documentElement,k={getViewportSize:function(a){return a.isW3C?function(){return{width:window.innerWidth,height:window.innerHeight}}:a.isIE?function(){return{width:j.clientWidth,height:j.clientHeight}}:function(){return{width:i.clientWidth,height:i.clientHeight}}}({isW3C:"undefined"!=typeof window.innerWidth,isIE:"undefined"!=typeof j&&"undefined"!=typeof j.clientWidth&&0!=j.clientWidth}),getTopScroll:function(){return i.scrollTop||j.scrollTop},getTopOffset:function(a){var b=this.getViewportSize().height,c=this.getTopScroll(),d=parseInt(a,10);return angular.isUndefined(a)?c+b/5+"px":isNaN(d)?c+"px":angular.isString(a)&&"%"===a.charAt(a.length-1)?c+b*d/100+"px":c+d+"px"},getElem:function(a){return angular.element('<section dialog="'+a.label+'"></section>').addClass(g.dialogClass+" "+a.dialogClass).css({zIndex:g.baseZindex+2*(a.label+1),top:this.getTopOffset(a.topOffset)})},updateMask:function(a,b){h.hasAny(b)?(a.css("z-index",g.baseZindex+2*h.dialogs.length-1),f.addClass(a,g.showClass)):f.removeClass(a,g.showClass,function(){a.removeAttr("style")})},eventLabel:function(a,b){return a+".dialog."+b},extendClass:function(a,b){return a?a+"-"+b:b}},l=function(b,d){var e=angular.element("<div />"),i=d.dialogRoot||g.mainNamespace;return b.append(e),e.addClass(k.extendClass(d.dialogRoot,g.maskClass)),e.bind("click",function(){var a=h.getUpperDialog();a.modal||(c.$emit(k.eventLabel(i,"close"),a),c.$digest())}),function(b,d,j){var l=k.extendClass(j.dialogRoot,g.rootClass),m=function(g,h){d.addClass(l),f.enter(a(k.getElem(h))(b),d,e),!c.$$phase&&c.$digest(),k.updateMask(e,i)},n=function(a,b){h.unRegisterDialog(b.label),!h.hasAny(i)&&d.removeClass(l),k.updateMask(e,i)};c.$on(k.eventLabel(i,"open"),m),c.$on(k.eventLabel(i,"close"),n)}};return{restrict:"A",compile:l}}]),a.directive("body",["$rootScope","$document","dialogConfig","dialogManager",function(a,b,c,d){var e=function(){b.on("keydown keypress",function(b){var e=d.getUpperDialog();27===b.which&&e&&(a.$emit((e.namespace||c.mainNamespace)+".dialog.close",e),a.$digest())})};return{restrict:"E",link:e}}]),a.constant("dialogConfig",{baseZindex:3e3,rootClass:"dialog-root",maskClass:"dialog-mask",dialogClass:"dialog",mainNamespace:"main",showClass:"show"}),a.factory("dialogData",["$log","dialogConfig",function(a,b){var c=function(){return angular.extend(this,{controller:null,controllerAs:null,dialogClass:"",topOffset:null,modal:!1,namespace:b.mainNamespace,templateUrl:null})};return angular.extend(c.prototype,{_updateDialogConfigData:function(b,c){return b.templateUrl||a.error(new Error('triNgDialog.DialogData() - initialData must contain defined "templateUrl"')),angular.extend(this,b,{data:c})}}),function(a,b){return(new c)._updateDialogConfigData(a,b)}}]),a.provider("dialogManager",["dialogConfig",function(a){var b=function(a,b,c){var d=function(){return angular.extend(this,{dialogs:[]})};return angular.extend(d.prototype,{hasAny:function(a){return this.dialogs.some(function(b){return b.namespace===a})},getUpperDialog:function(){var a=this.dialogs.length;return a>0&&this.dialogs[a-1]},registerDialog:function(a){return a.label=this.dialogs.push(a)-1,a},unRegisterDialog:function(a){var b=this.dialogs[a];return b&&b.label===a?(this.dialogs.splice(a,1),!0):!1},triggerDialog:function(d,e){return d=d||{},a.$emit((d.namespace||b.mainNamespace)+".dialog.open",this.registerDialog(c(d,e))),this}}),new d};return{config:function(b){return angular.extend(a,b),this},$get:["$rootScope","dialogConfig","dialogData",b]}}])}(angular.module("triNgDialog",["ng","ngAnimate"]));
//# sourceMappingURL=tri-angular-dialog.min.js.map