/*!
 * triAngular Dialog
 */
!function(a){"use strict";a.provider("dialogManager",function(){var a={baseZindex:3e3,rootClass:"dialog-root",maskClass:"dialog-mask",dialogClass:"dialog",showClass:"show",hideClass:"hide"},b=function(a){return{controller:a.controller||!1,dialogClass:a.dialogClass||"",topOffset:a.topOffset,modal:a.modal||!1,namespace:a.namespace||"main",templateUrl:a.templateUrl}},c=function(a){if(!a.templateUrl)throw new Error('dialog.DialogData() - initialData must contain defined "templateUrl"');var c=b(a);Object.keys(c).forEach(function(b){delete a[b]}),angular.extend(this,c),this.data=a};return{DialogData:c,configure:function(b){return angular.extend(a,b),this},$get:["$rootScope",function(b){return{dialogs:[],cfg:a,hasAny:function(a){return this.dialogs.filter(function(b){return b.namespace===a}).length>0},getUpperDialog:function(){var a=this.dialogs.length;return a>0&&this.dialogs[a-1]},registerDialog:function(a){return a.label=this.dialogs.push(a)-1,a},unregisterDialog:function(a){var b=this.dialogs[a];return b&&b.label===a?(delete b.label,this.dialogs.splice(a,1),!0):!1},triggerDialog:function(a){a=a||{},b.$emit((a.namespace?a.namespace+".":"main.")+"dialog.open",this.registerDialog(new c(a)))}}}]}}),a.directive("dialog",["$rootScope","$timeout","dialogManager",function(a,b,c){var d=document.body,e=document.documentElement,f={isW3C:"undefined"!=typeof window.innerWidth,isIE:"undefined"!=typeof e&&"undefined"!=typeof e.clientWidth&&0!=e.clientWidth},g=function(){return d.scrollTop||e.scrollTop},h=function(){var a=[f.isW3C,f.isIE,!0],b=[{width:window.innerWidth,height:window.innerHeight},{width:e.clientWidth,height:e.clientHeight},{width:d.clientWidth,height:d.clientHeight}];return b[a.indexOf(!0)]},i=function(a){var b=null!=a?parseInt(a,10):20;return{"true":g()+h().height*(b/100)+"px","false":g()+"px"}[!isNaN(b)]},j=function(d,e,f,g){var h=c.dialogs[f.dialog];null!=g?(g.data=g.data||{},angular.extend(g.data,h.data)):(d.data=d.data||{},angular.extend(d.data,h.data));var j={zIndex:c.cfg.baseZindex+2*(h.label+1),top:i(h.topOffset)};e.css(j).addClass(c.cfg.dialogClass).addClass(c.cfg.hideClass).addClass(h.dialogClass),b(function(){e.removeClass(c.cfg.hideClass).addClass(c.cfg.showClass)},100),d.closeClick=function(){a.$emit(h.namespace+".dialog.close",h)},a.$on(h.namespace+".dialog.close",function(a,d){d.label==h.label&&b(function(){e.removeClass(c.cfg.showClass).addClass(c.cfg.hideClass).css({zIndex:-1}),b(function(){e.remove()},600)},0)})};return{restrict:"A",require:"?ngController",link:j,scope:!0}}]),a.directive("dialogRoot",["$compile","$location","$rootScope","$interpolate","$document","dialogManager",function(a,b,c,d,e,f){var g={getElem:function(a){return angular.element(d('<section dialog="{{ label }}"'+(a.controller?' ng-controller="{{ controller }} as ctrl"':"")+"><div ng-include=\"'{{ templateUrl  }}'\" /></section>")(a))},updateMask:function(a,b){var c={css:{"true":f.cfg.baseZindex+2*f.dialogs.length-1,"false":-1},cls:{"true":f.cfg.showClass,"false":f.cfg.hideClass}},d=function(b){a.css("z-index",c.css[b]),a.removeClass(c.cls[!b]).addClass(c.cls[b])};d(f.hasAny(b))},eventLabel:function(a,b){return a+".dialog."+b},emit:function(a,b){var d=this;return{forThe:function(e,g,h){var i={"true":!e.modal,"false":!0,close:!!f.dialogs.length,open:!0};e&&i[a]&&i[!!h]&&(angular.isFunction(b)&&b(),c.$emit(d.eventLabel(g,a),e))}}},maskBasicClass:function(a,b){return a?a+"-"+b:b}},h=function(d,h){var i=angular.element("<div />"),j=h.dialogRoot||"main";return d.append(i),i.addClass(g.maskBasicClass(h.dialogRoot,f.cfg.maskClass)),i.bind("click",function(){g.emit("close").forThe(f.getUpperDialog(),j,!0)}),function(d,h,k){var l=k.dialogRoot?k.dialogRoot+"-"+f.cfg.rootClass:f.cfg.rootClass,m=function(b,e){h.addClass(l).append(a(g.getElem(e))(d)),!c.$$phase&&c.$digest(),g.updateMask(i,j)},n=function(a,b){f.unregisterDialog(b.label),!f.hasAny(j)&&h.removeClass(l),g.updateMask(i,j)};c.$on(g.eventLabel(j,"open"),m),c.$on(g.eventLabel(j,"close"),n),c.$on("historyBack",function(a,c){g.emit("close",function(){b.path(c)}).forThe(f.getUpperDialog(),j)}),e.bind("keydown keypress",function(a){var b=f.getUpperDialog();27===a.which&&b&&b.namespace===j&&g.emit("close").forThe(b,j)})}};return{restrict:"A",compile:h}}])}(angular.module("triNgDialog",[]));
//# sourceMappingURL=tri-angular-dialog.min.js.map