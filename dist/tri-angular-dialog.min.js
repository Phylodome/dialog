var tri;!function(t){var e;!function(t){"use strict";t.mod=angular.module("triNgDialog",["ngAnimate"])}(e=t.dialog||(t.dialog={}))}(tri||(tri={}));var tri;!function(t){var e;!function(t){"use strict";t.mod.directive("triDialogMask",["$animate","triDialogConfig","triDialogManager",function(t,e,o){var i=function(i,r,n,a,s){var l=r.parent(),g=null,c=null,d=function(t){t.css("z-index",e.baseZindex+2*o.dialogs.length-1)},u=function(){o.hasAny(a.namespace)?c?d(c):c=s(function(e){t.enter(e,l,r),d(e),g&&(g.remove(),g=null)}):c&&(t.leave(c,function(){g=null}),g=c,c=null)};i.$on(a.namespace+e.eventCore+e.eventOpen,u),i.$on(a.namespace+e.eventCore+e.eventClosing,u),t.leave(c)};return{link:i,priority:100,require:"^triDialogRoot",restrict:"A",terminal:!0,transclude:"element"}}]),t.mod.directive("triDialogMask",["triDialogManager","triDialogConfig",function(t,e){var o=function(t,o,i,r){o.addClass(r.maskClass+" "+e.maskClass)},i=function(o,i,r,n){i.on("click",function(){var i=t.getUpperDialog(),r={accepted:!1,dialog:i,status:"closing",reason:"maskClick"};i&&!i.modal&&(n.broadcast(e.eventClose,r),o.$digest())})};return{link:{pre:o,post:i},priority:-100,require:"^triDialogRoot",restrict:"A"}}])}(e=t.dialog||(t.dialog={}))}(tri||(tri={}));var tri;!function(t){var e;!function(t){"use strict";t.mod.run(["$rootScope","$document","triDialogConfig","triDialogManager",function(t,e,o,i){e.on("keydown keypress",function(e){var r,n;27===e.which&&i.dialogs.length&&(r=i.getUpperDialog(),n={accepted:!1,dialog:r,status:"closing",reason:"esc"},r.blockedDialog||(t.$broadcast(r.namespace+o.eventCore+o.eventClose,n),t.$digest()))})}]),t.mod.directive("triDialogRoot",["triDialogConfig","triDialogManager",function(t,e){var o=function(t,e,o,i){return this.namespace=e.triDialogRoot||o.mainNamespace,i.registerRoot(this),t.$on("$destroy",angular.bind(this,function(){i.unRegisterRoot(this)})),angular.extend(this,{maskClass:this.namespace+"-"+o.maskClass,rootClass:this.namespace+"-"+o.rootClass,dialogs:{},broadcast:function(e,i){t.$broadcast(this.namespace+o.eventCore+e,i)},listen:function(e,i){t.$on(this.namespace+o.eventCore+e,i)}})},i=function(o,i,r,n){n.listen(t.eventOpen,function(){i.addClass(n.rootClass+" "+t.rootClass)}),n.listen(t.eventClosing,function(){e.hasAny(n.namespace)||i.removeClass(n.rootClass+" "+t.rootClass)})},r=function(t){t.append("<div tri:dialog-mask/><div tri:dialog/>")};return{controller:["$scope","$attrs","triDialogConfig","triDialogManager",o],link:i,require:"triDialogRoot",restrict:"A",template:r}}])}(e=t.dialog||(t.dialog={}))}(tri||(tri={}));var tri;!function(t){var e;!function(t){"use strict";function e(t,e,o,i,r,n,a){var s=function(s,l,g,c,d){c.listen(n.eventOpen,function(r,s){var g=function(t,e){var i=o(s.controller,{$dialog:s,$data:s.data,$scope:e});s.controllerAs&&(e[s.controllerAs]=i),t.data("$triDialogController",i)},u=function(){var t={zIndex:n.baseZindex+2*(s.label+1)};return(n.processTopOffset||null!=s.topOffset)&&(t.top=a.getTopOffset(s.topOffset)),t};d(e.$new(),function(e,o){s.controller?g(e,o):o.$dialog=s,e.data("$triDialog",s).css(u()).addClass(n.dialogClass+" "+s.dialogClass),c.dialogs[s.label]=e,i(function(){s.notify("opening")},1),t.enter(e,l.parent(),l,function(){s.notify("open")})})}),c.listen(n.eventClose,function(e,o){var i,a=o.dialog,s=c.dialogs[a.label];s&&s.data("$triDialog")===a&&(i=s.scope(),t.leave(s,function(){i.$destroy(),s.removeData().children().removeData(),a.destroy(o),a=s=null}),delete c.dialogs[a.label],r.unRegisterDialog(a.label),c.broadcast(n.eventClosing,a))})};return{link:s,require:"^triDialogRoot",restrict:"A",scope:!0,transclude:"element",priority:600}}function o(t,e,o,i,r){var n=function(n,a){var s=a.data("$triDialog"),l=a.data("$triDialogController");e.get(s.templateUrl,{cache:i}).success(function(t){var e;a.html(t),e=o(a.contents()),l&&a.children().data("$triDialogController",l),e(n),s.notify("templateLoaded"),n.$broadcast(r.eventPrefix+r.eventTemplate+r.eventLoaded)}).error(function(){n.$broadcast(r.eventPrefix+r.eventTemplate+r.eventError),s.notify("templateError"),t.error(new Error("triDialog: could not load template!"))}),n.$broadcast(r.eventPrefix+r.eventTemplate+r.eventRequested)};return{link:n,require:"^triDialogRoot",restrict:"A"}}e.$inject=["$animate","$rootScope","$controller","$timeout","triDialogManager","triDialogConfig","triDialogUtilities"],o.$inject=["$log","$http","$compile","$templateCache","triDialogConfig"],t.mod.directive("triDialog",o),t.mod.directive("triDialog",e)}(e=t.dialog||(t.dialog={}))}(tri||(tri={}));var tri;!function(t){var e;!function(t){"use strict";var e={baseZindex:3e3,rootClass:"dialog-root",maskClass:"dialog-mask",dialogClass:"dialog",mainNamespace:"main",processTopOffset:!1,eventCore:"TriDialog",eventPrefix:"triDialog",eventOpen:"Open",eventClosing:"Closing",eventClose:"Close",eventLoaded:"Loaded",eventError:"Error",eventRequested:"Requested",eventTemplate:"Template"};t.mod.constant("triDialogConfig",e)}(e=t.dialog||(t.dialog={}))}(tri||(tri={}));var tri;!function(t){var e;!function(t){"use strict";var e=function(){function t(){this.dialogs=[],this.roots={}}return t.prototype.hasAny=function(t){return this.dialogs.some(function(e){return e.namespace===t})},t.prototype.getUpperDialog=function(){var t=this.dialogs.length;return t>0&&this.dialogs[t-1]},t.prototype.registerDialog=function(t){return t.label=this.dialogs.push(t)-1,t},t.prototype.unRegisterDialog=function(t){var e=this.dialogs[t];return e&&e.label===t?(this.dialogs.splice(t,1),!0):!1},t.prototype.triggerDialog=function(t){return this.roots.hasOwnProperty(t.namespace)?(this.roots[t.namespace].broadcast(this.$_dialogConfig.eventOpen,this.registerDialog(t)),this):(this.$_$log.error(new Error("TriDialog: rootCtrl "+t.namespace+" is not registered!")),this)},t.prototype.closeDialog=function(t){return this.roots.hasOwnProperty(t.dialog.namespace)?(this.roots[t.dialog.namespace].broadcast(this.$_dialogConfig.eventClose,t),this):(this.$_$log.error(new Error("TriDialog: rootCtrl "+t.dialog.namespace+" is not registered!")),this)},t.prototype.registerRoot=function(t){return t.namespace?this.roots.hasOwnProperty(t.namespace)?(this.$_$log.error(new Error("TriDialog: rootCtrl "+t.namespace+" already registered!")),this):(this.roots[t.namespace]=t,this):(this.$_$log.error(new Error("TriDialog: rootCtrl has no namespace assigned!")),this)},t.prototype.unRegisterRoot=function(t){return this.roots.hasOwnProperty(t.namespace)?(delete this.roots[t.namespace],this):(this.$_$log.error(new Error("TriDialog: rootCtrl "+t.namespace+" is not registered!")),this)},t}();t.mod.provider("triDialogManager",["triDialogConfig",function(t){return{config:function(e){return angular.extend(t,e),this},$get:["$log","triDialogConfig",function(t,o){return angular.extend(e.prototype,{$_$log:t,$_dialogConfig:o}),new e}]}}])}(e=t.dialog||(t.dialog={}))}(tri||(tri={}));var tri;!function(t){var e;!function(t){"use strict";var e=document.body,o=document.documentElement,i={isW3C:"undefined"!=typeof window.innerWidth,isIE:"undefined"!=typeof o&&"undefined"!=typeof o.clientWidth&&0!=o.clientWidth},r=function(){function t(){}return t.prototype.getViewportSize=function(){return i.isW3C?{width:window.innerWidth,height:window.innerHeight}:i.isIE?{width:o.clientWidth,height:o.clientHeight}:{width:e.clientWidth,height:e.clientHeight}},t.prototype.getTopScroll=function(){return e.scrollTop||o.scrollTop},t.prototype.getTopOffset=function(t){var e=this.getViewportSize().height,o=this.getTopScroll(),i=parseInt(t,10);return null==t?o+e/5+"px":isNaN(i)?o+"px":angular.isString(t)&&"%"===t.charAt(t.length-1)?o+e*i/100+"px":o+i+"px"},t}();t.mod.service("triDialogUtilities",r)}(e=t.dialog||(t.dialog={}))}(tri||(tri={}));var tri;!function(t){var e;!function(t){"use strict";var e=function(){function t(t,e){angular.extend(this,{blockedDialog:!1,controller:null,controllerAs:null,dialogClass:"",topOffset:null,modal:!1,namespace:this.$_dialogConfig.mainNamespace,templateUrl:null,$_deferred:this.$_$q.defer()}),t.templateUrl||this.$_$log.error(new Error('triNgDialog.DialogData() - initialData must contain defined "templateUrl"')),angular.extend(this,t,{data:e,modal:t.blockedDialog||t.modal||this.modal,promise:this.$_deferred.promise})}return t.prototype.accept=function(t){return this.close(t,!1)},t.prototype.cancel=function(t){return this.close(t,!0)},t.prototype.close=function(t,e){return void 0===e&&(e=!1),this.$_dialogManager.closeDialog({accepted:!e,dialog:this,reason:t,status:"closing"}),this.notify("closing")},t.prototype.destroy=function(t){var e;t.accepted?this.$_deferred.resolve(t.reason):this.$_deferred.reject(t.reason);for(e in this)this.hasOwnProperty(e)&&delete this[e]},t.prototype.notify=function(t){return this.$_deferred.notify({dialog:this,status:t}),this},t.prototype.trigger=function(){return this.$_dialogManager.triggerDialog(this),this},t}();t.mod.factory("triDialog",["$log","$q","triDialogConfig","triDialogManager",function(t,o,i,r){return angular.extend(e.prototype,{$_$log:t,$_$q:o,$_dialogConfig:i,$_dialogManager:r}),function(t,o){return new e(t,o).trigger()}}])}(e=t.dialog||(t.dialog={}))}(tri||(tri={}));
//# sourceMappingURL=../dist/tri-angular-dialog.min.js.map