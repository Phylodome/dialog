/*!
 * triAngular Dialog
 */
!function(a){"use strict";a.directive("dialog",["$rootScope","$http","$animate","$compile","$templateCache","dialogManager",function(a,b,c,d,e,f){var g=function(g,h,i){var j=f.dialogs[i.dialog];g.data=g.data||{},angular.extend(g.data,j.data),j.hasOwnProperty("dynamicParams")&&angular.extend(g,{params:j.dynamicParams}),angular.isObject(j.scope)&&angular.extend(g,j.scope),b.get(j.templateUrl,{cache:e}).success(function(a){h.html(a),d(h.contents())(g),g.$emit("$triNgDialogTemplateLoaded")}).error(function(){g.$emit("$triNgDialogTemplateError")}),g.$emit("$triNgDialogTemplateRequested"),g.closeClick=function(){a.$emit(j.namespace+".dialog.close",j)},a.$on(j.namespace+".dialog.close",function(a,b){b.label==j.label&&(g.$destroy(),c.leave(h))})};return{restrict:"A",link:g,scope:!0}}]),a.directive("dialogRoot",["$compile","$location","$rootScope","$interpolate","$document","$animate","dialogManager",function(a,b,c,d,e,f,g){var h=document.body,i=document.documentElement,j={getViewportSize:function(a){return a.isW3C?function(){return{width:window.innerWidth,height:window.innerHeight}}:a.isIE?function(){return{width:i.clientWidth,height:i.clientHeight}}:function(){return{width:h.clientWidth,height:h.clientHeight}}}({isW3C:"undefined"!=typeof window.innerWidth,isIE:"undefined"!=typeof i&&"undefined"!=typeof i.clientWidth&&0!=i.clientWidth}),getTopScroll:function(){return h.scrollTop||i.scrollTop},getTopOffset:function(a){var b=null!=a?parseInt(a,10):20;return isNaN(b)?this.getTopScroll()+"px":this.getTopScroll()+this.getViewportSize().height*(b/100)+"px"},getElem:function(a){return angular.element(d('<section dialog="{{ label }}"'+(a.controller?' ng-controller="{{ controller }} as ctrl"':"")+"></section>")(a)).addClass(g.cfg.dialogClass+" "+a.dialogClass).css({zIndex:g.cfg.baseZindex+2*(a.label+1),top:this.getTopOffset(a.topOffset)})},updateMask:function(a,b){g.hasAny(b)?(a.css("z-index",g.cfg.baseZindex+2*g.dialogs.length-1),f.addClass(a,g.cfg.showClass)):f.removeClass(a,g.cfg.showClass,function(){a.removeAttr("style")})},eventLabel:function(a,b){return a+".dialog."+b},extendClass:function(a,b){return a?a+"-"+b:b}},k=function(b,d){var e=angular.element("<div />"),h=d.dialogRoot||g.cfg.mainNamespace;return b.append(e),e.addClass(j.extendClass(d.dialogRoot,g.cfg.maskClass)),e.bind("click",function(){var a=g.getUpperDialog();a.modal||(c.$emit(j.eventLabel(h,"close"),a),c.$digest())}),function(b,d,i){var k=j.extendClass(i.dialogRoot,g.cfg.rootClass),l=function(g,i){d.addClass(k),f.enter(a(j.getElem(i))(b),d,e),!c.$$phase&&c.$digest(),j.updateMask(e,h)},m=function(a,b){g.unregisterDialog(b.label),!g.hasAny(h)&&d.removeClass(k),j.updateMask(e,h)};c.$on(j.eventLabel(h,"open"),l),c.$on(j.eventLabel(h,"close"),m)}};return{restrict:"A",compile:k}}]),a.directive("body",["$rootScope","$document","dialogManager",function(a,b,c){var d=function(){b.on("keydown keypress",function(b){var d=c.getUpperDialog();27===b.which&&d&&(a.$emit((d.namespace||c.cfg.mainNamespace)+".dialog.close",d),a.$digest())})};return{restrict:"E",link:d}}]),a.provider("dialogManager",function(){var a={baseZindex:3e3,rootClass:"dialog-root",maskClass:"dialog-mask",dialogClass:"dialog",mainNamespace:"main",showClass:"show",hideClass:"hide"},b=function(b){return{controller:b.controller||!1,dialogClass:b.dialogClass||"",topOffset:b.topOffset,modal:b.modal||!1,namespace:b.namespace||a.mainNamespace,templateUrl:b.templateUrl}},c=function(c,d){var e=function(){return angular.extend(this,{dialogs:[],cfg:a})},f=function(a){var c;return a.templateUrl||d.error(new Error('triNgDialog.DialogData() - initialData must contain defined "templateUrl"')),c=b(a),a.scope&&(c.scope=a.scope),a.dynamicParams&&(c.dynamicParams=a.dynamicParams),Object.keys(c).forEach(function(b){delete a[b]}),angular.extend(this,c,{data:a})};return angular.extend(e.prototype,{hasAny:function(a){return this.dialogs.filter(function(b){return b.namespace===a}).length>0},getUpperDialog:function(){var a=this.dialogs.length;return a>0&&this.dialogs[a-1]},registerDialog:function(a){return a.label=this.dialogs.push(a)-1,a},unregisterDialog:function(a){var b=this.dialogs[a];return b&&b.label===a?(this.dialogs.splice(a,1),!0):!1},triggerDialog:function(a){return a=a||{},c.$emit((a.namespace||this.cfg.mainNamespace)+".dialog.open",this.registerDialog(new f(a))),this}}),new e};return{config:function(b){return angular.extend(a,b),this},$get:["$rootScope","$log",c]}})}(angular.module("triNgDialog",["ng","ngAnimate"]));
//# sourceMappingURL=tri-angular-dialog.min.js.map