{"version":3,"sources":["module/dialog-module.ts","module/directives/dialog-mask.ts","module/directives/dialog-root.js","module/directives/dialog.ts","module/services/dialog-config.js","module/services/dialog-manager.ts","module/services/dialog-utilities.js","module/services/dialog.js"],"names":["tri","tri.dialog","postLink","scope","element","attrs","rootCtrl","$transclude","root","parent","previousElement","currentElement","updateZIndex","mask","css","dialogConfig","baseZindex","dialogManager","dialogs","length","update","hasAny","namespace","clone","$animate","enter","remove","leave","$on","eventCore","eventOpen","eventClosing","link","priority","require","restrict","terminal","transclude","preLink","addClass","maskClass","on","upperDialog","getUpperDialog","notification","accepted","dialog","status","reason","modal","broadcast","eventClose","$digest","pre","post","mod","run","$rootScope","$document","event","which","blockedDialog","$broadcast","directive","controller","$scope","$attrs","this","triDialogRoot","mainNamespace","registerRoot","angular","bind","unRegisterRoot","extend","rootClass","eType","eData","listen","eFn","dialogRootCtrl","removeClass","template","tElement","append","tri.dialog.triDialogManipulator","setController","dialogScope","dialogCtrl","$controller","$dialog","$data","data","controllerAs","getCss","zIndex","label","processTopOffset","topOffset","top","dialogUtilities","getTopOffset","$transcludeFn","$new","dialogClass","$timeout","notify","tri.dialog.triDialog","triDialogConfig","eventPrefix","eventLoaded","eventError","eventRequested","eventTemplate","constant","tri.dialog.DialogManagerService","tri.dialog.DialogManagerService.constructor","tri.dialog.DialogManagerService.hasAny","tri.dialog.DialogManagerService.getUpperDialog","tri.dialog.DialogManagerService.registerDialog","tri.dialog.DialogManagerService.unRegisterDialog","tri.dialog.DialogManagerService.triggerDialog","tri.dialog.DialogManagerService.closeDialog","tri.dialog.DialogManagerService.registerRoot","tri.dialog.DialogManagerService.unRegisterRoot","tri.dialog.config","docBody","document","body","docElem","documentElement","viewportStyle","isW3C","window","innerWidth","isIE","clientWidth","DialogUtilities","prototype","getViewportSize","width","height","innerHeight","clientHeight","getTopScroll","scrollTop","_vh","_ts","_parsed","parseInt","isNaN","isString","charAt","service","DialogData","config","$_dialogConfig","templateUrl","$_deferred","$_$q","defer","$_$log","error","Error","promise","accept","close","cancel","reject","$_dialogManager","closeDialog","destroy","key","resolve","hasOwnProperty","trigger","triggerDialog","factory","$log","$q"],"mappings":"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","file":"tri-angular-dialog.min.js","sourcesContent":["\nmodule tri.dialog {\n\n    'use strict';\n\n    export var mod = angular.module('triNgDialog', [\n        'ngAnimate'\n    ]);\n\n}","\nmodule tri.dialog {\n\n    'use strict';\n\n    mod.directive('triDialogMask', [\n        '$animate',\n        'triDialogConfig',\n        'triDialogManager',\n        function (\n            $animate: ng.IAnimateService,\n            dialogConfig: ITriDialogBaseConfig,\n            dialogManager: ITriDialogManagerService\n        ) {\n\n            var postLink = function (scope, element, attrs, rootCtrl, $transclude) {\n\n                var root: ng.IAugmentedJQuery = element.parent();\n                var previousElement: ng.IAugmentedJQuery = null;\n                var currentElement: ng.IAugmentedJQuery = null;\n\n                var updateZIndex = function (mask) {\n                    mask.css('z-index', dialogConfig.baseZindex + dialogManager.dialogs.length * 2 - 1);\n                };\n\n                var update = function () {\n                    if (dialogManager.hasAny(rootCtrl.namespace)) {\n                        if (currentElement) {\n                            updateZIndex(currentElement);\n                        } else {\n                            currentElement = $transclude((clone) => {\n                                $animate.enter(clone, root, element);\n                                updateZIndex(clone);\n                                if (previousElement) {\n                                    previousElement.remove();\n                                    previousElement = null;\n                                }\n                            });\n                        }\n                    } else if (currentElement) {\n                        $animate.leave(currentElement, function () {\n                            previousElement = null;\n                        });\n                        previousElement = currentElement;\n                        currentElement = null;\n                    }\n                };\n\n                scope.$on(rootCtrl.namespace + dialogConfig.eventCore + dialogConfig.eventOpen, update);\n                scope.$on(rootCtrl.namespace + dialogConfig.eventCore + dialogConfig.eventClosing, update);\n\n                $animate.leave(currentElement);\n            };\n\n            return {\n                link: postLink,\n                priority: 100,\n                require: '^triDialogRoot',\n                restrict: 'A',\n                terminal: true,\n                transclude: 'element'\n            };\n        }\n    ]);\n\n    mod.directive('triDialogMask', [\n        'triDialogManager',\n        'triDialogConfig',\n        function (dialogManager: ITriDialogManagerService, dialogConfig: ITriDialogBaseConfig) {\n            var preLink = function (scope, element, attrs, rootCtrl) {\n                element.addClass(rootCtrl.maskClass + ' ' + dialogConfig.maskClass);\n            };\n\n            var postLink = function (scope, element, attrs, rootCtrl) {\n                element.on('click', function () {\n                    var upperDialog = dialogManager.getUpperDialog();\n                    var notification: ITriDialogPromiseNotification = {\n                        accepted: false,\n                        dialog: upperDialog,\n                        status: 'closing',\n                        reason: 'maskClick'\n                    };\n                    if (upperDialog && !upperDialog.modal) {\n                        rootCtrl.broadcast(dialogConfig.eventClose, notification);\n                        scope.$digest();\n                    }\n                });\n            };\n\n            return {\n                link: {\n                    pre: preLink,\n                    post: postLink\n                },\n                priority: -100,\n                require: '^triDialogRoot',\n                restrict: 'A'\n            };\n        }\n    ]);\n\n}\n\n\n","var tri;\n(function (tri) {\n    var dialog;\n    (function (dialog) {\n        'use strict';\n        dialog.mod.run([\n            '$rootScope',\n            '$document',\n            'triDialogConfig',\n            'triDialogManager',\n            function ($rootScope, $document, dialogConfig, dialogManager) {\n                // TODO: add some namespaces\n                $document.on('keydown keypress', function (event) {\n                    // kind'a imperative, but we do not know if ng-app/$rootElement is on body/html or not\n                    var upperDialog;\n                    var notification;\n                    if (event.which === 27 && dialogManager.dialogs.length) {\n                        upperDialog = dialogManager.getUpperDialog();\n                        notification = {\n                            accepted: false,\n                            dialog: upperDialog,\n                            status: 'closing',\n                            reason: 'esc'\n                        };\n                        if (!upperDialog.blockedDialog) {\n                            $rootScope.$broadcast(upperDialog.namespace + dialogConfig.eventCore + dialogConfig.eventClose, notification);\n                            $rootScope.$digest();\n                        }\n                    }\n                });\n            }\n        ]);\n        dialog.mod.directive('triDialogRoot', [\n            'triDialogConfig',\n            'triDialogManager',\n            function (dialogConfig, dialogManager) {\n                var controller = function ($scope, $attrs, dialogConfig, dialogManager) {\n                    this.namespace = $attrs.triDialogRoot || dialogConfig.mainNamespace;\n                    dialogManager.registerRoot(this);\n                    $scope.$on('$destroy', angular.bind(this, function () {\n                        //noinspection JSPotentiallyInvalidUsageOfThis\n                        dialogManager.unRegisterRoot(this);\n                    }));\n                    return angular.extend(this, {\n                        maskClass: this.namespace + '-' + dialogConfig.maskClass,\n                        rootClass: this.namespace + '-' + dialogConfig.rootClass,\n                        dialogs: {},\n                        broadcast: function (eType, eData) {\n                            //noinspection JSPotentiallyInvalidUsageOfThis\n                            $scope.$broadcast(this.namespace + dialogConfig.eventCore + eType, eData);\n                        },\n                        listen: function (eType, eFn) {\n                            //noinspection JSPotentiallyInvalidUsageOfThis\n                            $scope.$on(this.namespace + dialogConfig.eventCore + eType, eFn);\n                        }\n                    });\n                };\n                var postLink = function (scope, element, attrs, dialogRootCtrl) {\n                    dialogRootCtrl.listen(dialogConfig.eventOpen, function () {\n                        element.addClass(dialogRootCtrl.rootClass + ' ' + dialogConfig.rootClass);\n                    });\n                    dialogRootCtrl.listen(dialogConfig.eventClosing, function () {\n                        if (!dialogManager.hasAny(dialogRootCtrl.namespace)) {\n                            element.removeClass(dialogRootCtrl.rootClass + ' ' + dialogConfig.rootClass);\n                        }\n                    });\n                };\n                var template = function (tElement) {\n                    tElement.append('<div tri:dialog-mask/><div tri:dialog/>');\n                };\n                return {\n                    controller: ['$scope', '$attrs', 'triDialogConfig', 'triDialogManager', controller],\n                    link: postLink,\n                    require: 'triDialogRoot',\n                    restrict: 'A',\n                    template: template\n                };\n            }\n        ]);\n    })(dialog = tri.dialog || (tri.dialog = {}));\n})(tri || (tri = {}));\n","\nmodule tri.dialog {\n\n    'use strict';\n\n    triDialogManipulator.$inject = [\n        '$animate', '$rootScope', '$controller', '$timeout',\n        'triDialogManager', 'triDialogConfig', 'triDialogUtilities'\n    ];\n    function triDialogManipulator(\n        $animate: ng.IAnimateService,\n        $rootScope: ng.IRootScopeService,\n        $controller: ng.IControllerService,\n        $timeout: ng.ITimeoutService,\n        dialogManager: ITriDialogManagerService,\n        dialogConfig: ITriDialogBaseConfig,\n        dialogUtilities: ITriDialogUtilitiesService\n    ) {\n\n        var postLink = (scope, element, attrs, dialogRootCtrl, $transcludeFn) => {\n\n            dialogRootCtrl.listen(dialogConfig.eventOpen, function (e, dialog: ITriDialog) {\n\n                var setController = (clone, dialogScope) => {\n                    var dialogCtrl = $controller(dialog.controller, {\n                        $dialog: dialog,\n                        $data: dialog.data,\n                        $scope: dialogScope\n                    });\n                    if (dialog.controllerAs) {\n                        dialogScope[dialog.controllerAs] = dialogCtrl;\n                    }\n                    clone.data('$triDialogController', dialogCtrl);\n                };\n\n                var getCss = () => {\n                    var css: ITriDialogStyle = {\n                        zIndex: dialogConfig.baseZindex + (dialog.label + 1) * 2\n                    };\n                    if (dialogConfig.processTopOffset || dialog.topOffset != null) {\n                        css.top = dialogUtilities.getTopOffset(dialog.topOffset);\n                    }\n                    return css;\n                };\n\n                $transcludeFn($rootScope.$new(), (clone, dialogScope) => {\n\n                    if (dialog.controller) {\n                        setController(clone, dialogScope);\n                    } else {\n                        dialogScope.$dialog = dialog;\n                    }\n\n                    clone\n                        .data('$triDialog', dialog)\n                        .css(getCss())\n                        .addClass(dialogConfig.dialogClass + ' ' + dialog.dialogClass);\n\n                    dialogRootCtrl.dialogs[dialog.label] = clone;\n\n                    $timeout(() => {\n                        dialog.notify('opening');\n                    }, 1);\n\n                    $animate.enter(clone, element.parent(), element, () => {\n                        dialog.notify('open');\n                    });\n                });\n            });\n\n            dialogRootCtrl.listen(dialogConfig.eventClose, (e, notification: ITriDialogPromiseFinalisation) => {\n                var closedDialog: ITriDialog = notification.dialog;\n                var dialogElement = dialogRootCtrl.dialogs[closedDialog.label];\n                var dialogElementScope;\n\n                if (dialogElement && dialogElement.data('$triDialog') === closedDialog) {\n                    dialogElementScope = dialogElement.scope();\n\n                    $animate.leave(dialogElement, () => {\n                        dialogElementScope.$destroy();\n                        dialogElement.removeData().children().removeData();\n                        closedDialog.destroy(notification);\n                        closedDialog = dialogElement = null;\n                    });\n\n                    delete dialogRootCtrl.dialogs[closedDialog.label];\n                    dialogManager.unRegisterDialog(closedDialog.label);\n                    dialogRootCtrl.broadcast(dialogConfig.eventClosing, closedDialog);\n                }\n            });\n        };\n\n        return {\n            link: postLink,\n            require: '^triDialogRoot',\n            restrict: 'A',\n            scope: true,\n            transclude: 'element',\n            priority: 600\n        };\n    }\n\n    triDialog.$inject = ['$log', '$http', '$compile', '$templateCache', 'triDialogConfig'];\n    function triDialog(\n        $log: ng.ILogService,\n        $http: ng.IHttpService,\n        $compile: ng.ICompileService,\n        $templateCache: ng.ITemplateCacheService,\n        dialogConfig: ITriDialogBaseConfig\n    ) {\n\n        var postLink = (scope, element) => {\n\n            var dialog: ITriDialog = element.data('$triDialog');\n            var dialogCtrl = element.data('$triDialogController');\n\n            $http.get(dialog.templateUrl, {\n                cache: $templateCache\n            }).success((response) => {\n                var innerLink;\n                element.html(response);\n                innerLink = $compile(element.contents());\n                if (dialogCtrl) {\n                    element.children().data('$triDialogController', dialogCtrl);\n                }\n                innerLink(scope);\n                dialog.notify('templateLoaded');\n                scope.$broadcast(dialogConfig.eventPrefix + dialogConfig.eventTemplate + dialogConfig.eventLoaded);\n            }).error(() => {\n                scope.$broadcast(dialogConfig.eventPrefix + dialogConfig.eventTemplate + dialogConfig.eventError);\n                dialog.notify('templateError');\n                $log.error(new Error('triDialog: could not load template!'));\n            });\n\n            scope.$broadcast(dialogConfig.eventPrefix + dialogConfig.eventTemplate + dialogConfig.eventRequested);\n\n        };\n\n        return {\n            link: postLink,\n            require: '^triDialogRoot',\n            restrict: 'A'\n        };\n    }\n\n    mod.directive('triDialog', triDialog);\n    mod.directive('triDialog', triDialogManipulator);\n\n}","var tri;\n(function (tri) {\n    var dialog;\n    (function (dialog) {\n        'use strict';\n        var triDialogConfig = {\n            baseZindex: 3000,\n            rootClass: 'dialog-root',\n            maskClass: 'dialog-mask',\n            dialogClass: 'dialog',\n            mainNamespace: 'main',\n            processTopOffset: false,\n            eventCore: 'TriDialog',\n            eventPrefix: 'triDialog',\n            eventOpen: 'Open',\n            eventClosing: 'Closing',\n            eventClose: 'Close',\n            eventLoaded: 'Loaded',\n            eventError: 'Error',\n            eventRequested: 'Requested',\n            eventTemplate: 'Template'\n        };\n        dialog.mod.constant('triDialogConfig', triDialogConfig);\n    })(dialog = tri.dialog || (tri.dialog = {}));\n})(tri || (tri = {}));\n","\nmodule tri.dialog {\n\n    'use strict';\n\n    class DialogManagerService implements ITriDialogManagerService {\n\n        public dialogs: Array<ITriDialog> = [];\n        public roots: {[namespace: string]: ITriDialogRootCtrl} = {};\n\n        private $_$log: ng.ILogService;\n        private $_dialogConfig: ITriDialogBaseConfig;\n\n        hasAny(namespace: string): boolean {\n            return this.dialogs.some((dialog) => dialog.namespace === namespace);\n        }\n\n        getUpperDialog(): ITriDialog {\n            var count = this.dialogs.length;\n            return count > 0 && this.dialogs[count - 1];\n        }\n\n        registerDialog(dialog: ITriDialog): ITriDialog {\n            dialog.label = this.dialogs.push(dialog) - 1;\n            return dialog;\n        }\n\n        unRegisterDialog(label: number): boolean {\n            var dialog = this.dialogs[label];\n            if (dialog && dialog.label === label) {\n                this.dialogs.splice(label, 1);\n                return true;\n            }\n            return false;\n        }\n\n        triggerDialog(dialog: ITriDialog): ITriDialogManagerService {\n            if (!this.roots.hasOwnProperty(dialog.namespace)) {\n                this.$_$log.error(new Error('TriDialog: rootCtrl ' + dialog.namespace + ' is not registered!'));\n                return this;\n            }\n            this.roots[dialog.namespace].broadcast(this.$_dialogConfig.eventOpen, this.registerDialog(dialog));\n            return this;\n        }\n\n        closeDialog(notification: ITriDialogPromiseFinalisation): ITriDialogManagerService {\n            if (!this.roots.hasOwnProperty(notification.dialog.namespace)) {\n                this.$_$log.error(\n                    new Error('TriDialog: rootCtrl ' + notification.dialog.namespace + ' is not registered!')\n                );\n                return this;\n            }\n            this.roots[notification.dialog.namespace].broadcast(this.$_dialogConfig.eventClose, notification);\n            return this;\n        }\n\n        registerRoot(ctrl: ITriDialogRootCtrl): ITriDialogManagerService {\n            if (!ctrl.namespace) {\n                this.$_$log.error(new Error('TriDialog: rootCtrl has no namespace assigned!'));\n                return this;\n            }\n            if (this.roots.hasOwnProperty(ctrl.namespace)) {\n                this.$_$log.error(new Error('TriDialog: rootCtrl ' + ctrl.namespace + ' already registered!'));\n                return this;\n            }\n            this.roots[ctrl.namespace] = ctrl;\n            return this;\n        }\n\n        unRegisterRoot(ctrl: ITriDialogRootCtrl): ITriDialogManagerService {\n            if (!this.roots.hasOwnProperty(ctrl.namespace)) {\n                this.$_$log.error(new Error('TriDialog: rootCtrl ' + ctrl.namespace + ' is not registered!'));\n                return this;\n            }\n            delete this.roots[ctrl.namespace];\n            return this;\n        }\n    }\n\n    mod.provider('triDialogManager', [\n        'triDialogConfig',\n        (triDialogConfig: ITriDialogBaseConfig): ITriDialogManagerProvider => ({\n            config(cfg) {\n                angular.extend(triDialogConfig, cfg);\n                return this;\n            },\n            $get: ['$log', 'triDialogConfig', (\n                $log: ng.ILogService,\n                triDialogConfig: ITriDialogBaseConfig\n            ): ITriDialogManagerService => {\n                angular.extend(DialogManagerService.prototype, {\n                    $_$log: $log,\n                    $_dialogConfig: triDialogConfig\n                });\n                return new DialogManagerService();\n            }]\n        })\n    ]);\n\n}","var tri;\n(function (tri) {\n    var dialog;\n    (function (dialog) {\n        'use strict';\n        var docBody = document.body;\n        var docElem = document.documentElement;\n        /* tslint:disable:triple-equals */\n        var viewportStyle = {\n            isW3C: (typeof window.innerWidth != 'undefined'),\n            isIE: (typeof docElem != 'undefined' && typeof docElem.clientWidth != 'undefined' && docElem.clientWidth != 0)\n        };\n        /* tslint:enable:triple-equals */\n        var DialogUtilities = (function () {\n            function DialogUtilities() {\n            }\n            DialogUtilities.prototype.getViewportSize = function () {\n                if (viewportStyle.isW3C) {\n                    return {\n                        width: window.innerWidth,\n                        height: window.innerHeight\n                    };\n                }\n                if (viewportStyle.isIE) {\n                    return {\n                        width: docElem.clientWidth,\n                        height: docElem.clientHeight\n                    };\n                }\n                return {\n                    width: docBody.clientWidth,\n                    height: docBody.clientHeight\n                };\n            };\n            DialogUtilities.prototype.getTopScroll = function () {\n                return docBody.scrollTop || docElem.scrollTop;\n            };\n            DialogUtilities.prototype.getTopOffset = function (topOffset) {\n                var _vh = this.getViewportSize().height;\n                var _ts = this.getTopScroll();\n                var _parsed = parseInt(topOffset, 10);\n                if (topOffset == null) {\n                    return _ts + _vh / 5 + 'px';\n                }\n                else if (!isNaN(_parsed)) {\n                    if (angular.isString(topOffset) && topOffset.charAt(topOffset.length - 1) === '%') {\n                        return _ts + _vh * _parsed / 100 + 'px';\n                    }\n                    return _ts + _parsed + 'px';\n                }\n                return _ts + 'px';\n            };\n            return DialogUtilities;\n        })();\n        dialog.mod.service('triDialogUtilities', DialogUtilities);\n    })(dialog = tri.dialog || (tri.dialog = {}));\n})(tri || (tri = {}));\n","var tri;\n(function (tri) {\n    var dialog;\n    (function (dialog) {\n        'use strict';\n        var DialogData = (function () {\n            function DialogData(config, data) {\n                angular.extend(this, {\n                    blockedDialog: false,\n                    controller: null,\n                    controllerAs: null,\n                    dialogClass: '',\n                    topOffset: null,\n                    modal: false,\n                    namespace: this.$_dialogConfig.mainNamespace,\n                    templateUrl: null,\n                    $_deferred: this.$_$q.defer()\n                });\n                if (!config.templateUrl) {\n                    this.$_$log.error(new Error('triNgDialog.DialogData() - initialData must contain defined \"templateUrl\"'));\n                }\n                angular.extend(this, config, {\n                    data: data,\n                    modal: config.blockedDialog || config.modal || this.modal,\n                    promise: this.$_deferred.promise\n                });\n            }\n            DialogData.prototype.accept = function (reason) {\n                return this.close(reason, false);\n            };\n            DialogData.prototype.cancel = function (reason) {\n                return this.close(reason, true);\n            };\n            DialogData.prototype.close = function (reason, reject) {\n                if (reject === void 0) { reject = false; }\n                this.$_dialogManager.closeDialog({\n                    accepted: !reject,\n                    dialog: this,\n                    reason: reason,\n                    status: 'closing'\n                });\n                return this.notify('closing');\n            };\n            DialogData.prototype.destroy = function (notification) {\n                var key;\n                if (notification.accepted) {\n                    this.$_deferred.resolve(notification.reason);\n                }\n                else {\n                    this.$_deferred.reject(notification.reason);\n                }\n                for (key in this) {\n                    if (this.hasOwnProperty(key)) {\n                        delete this[key];\n                    }\n                }\n            };\n            DialogData.prototype.notify = function (status) {\n                this.$_deferred.notify({ dialog: this, status: status });\n                return this;\n            };\n            DialogData.prototype.trigger = function () {\n                this.$_dialogManager.triggerDialog(this);\n                return this;\n            };\n            return DialogData;\n        })();\n        dialog.mod.factory('triDialog', [\n            '$log',\n            '$q',\n            'triDialogConfig',\n            'triDialogManager',\n            function ($log, $q, dialogConfig, dialogManager) {\n                angular.extend(DialogData.prototype, {\n                    $_$log: $log,\n                    $_$q: $q,\n                    $_dialogConfig: dialogConfig,\n                    $_dialogManager: dialogManager\n                });\n                return function (config, data) { return new DialogData(config, data).trigger(); };\n            }\n        ]);\n    })(dialog = tri.dialog || (tri.dialog = {}));\n})(tri || (tri = {}));\n"],"sourceRoot":"/source/"}